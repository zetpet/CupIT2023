# Cup IT 2023 
## Ранжирование комментариев с помощью ML 
![alt-текст](data:image/png;base64,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 "Пасхалка")

## Состав команды:
- Наумовская Анастасия
- Абабков Роман
- Николаев Иван
- Староверов Максим
- Габитов Тимур

## Постановка задачи
Предложите механизм сортировки комментариев к постам по их популярности на основе методов 
машинного обучения, чтобы модель могла как можно лучше ранжировать пользовательские комментарии

- Проведите проверку и разведочный анализ данных (EDA) и подумайте, какие готовые решения можно 
использовать для представления текста.
- Используя тренировочную и тестовую выборки датасета, обучите модель ранжировать текстовые комментарии в порядке их популярности (от популярных к менее популярным) и проведите валидацию 
своей модели. Выбор модели необходимо аргументировать, основываясь на результатах обучения.
- Проанализируйте полученные результаты и сформулируйте полезные инсайты о том, что обычно содержит популярный комментарий, чтобы команда VK могла использовать эту информацию для улучшения комментариев своих пользователей.
- Предложите методы взаимодействия с комментаторами, а также механизмы поддержки для разных 
групп пользователей, включая тех, чьи комментарии непопулярны. 

## Структура решения

- **New_features_from_df**
> Выделяем новые фичи на основе комментариев и текстов постов
> анализируем влияние сгенерированных фичей на score
> Фичи для комментариев: len_with_spaces (длина комментариев, деленная по пробелам), links (индикатор содержания ссылки), emoji (индикатор содержания спецсимволов &#x), money (индикатор содержания знака $), quotes (индикатор содержания цитирования), col_sentence (количество предложений), tokenized (выделение токенизированных слов), col_words (количество слов), punc_count (количество знаков препинания), avg_len_words (средняя длина слов), total_digits (общее количество цифр), total_letters (общее количество букв)
> Фичи для текста: len_with_spaces (длина комментариев, деленная по пробелам), links (индикатор содержания ссылки), emoji_pic (количество эмодзи, содержащиеся в тексте), money (индикатор содержания знака $), quotes (индикатор содержания цитирования), col_sentence (количество предложений), col_words (количество слов), punc_count (количество знаков препинания), avg_len_words (средняя длина слов), total_digits (общее количество цифр), total_letters (общее количество букв)
- **EDA_features**
> Общий анализ фич из текста и комментария, выделения инсайтов
- **BERT**
> Выборка одного батча данных (1000), удаление спецсимволов, стопслов, нормализация. Обучение предобученной нейронной сети для векторизации признаков. Классификация с помощью различных методов
- **CountVectorizer()**
> Векторизуем данные с помощью CountVectorizer() и одновременно с его же помощью удаляем стопслова, нормализуем и разбиваем на токены. Используем MultinomialNB для классификации, либо после применяем TFIDF-трансформер и классифицируем с помощью MultinomialNB
- **TFIDF**
> Удаление спецсимволов, стопслов, нормализация. Векторизуем предложения с помощью TFIDFVectorizer и с помощью различных классификатор оцениваем score
- **ranking_test_solution.jsonl**
> Заполненный score на тестовой выборке
- **Презентация решения**

### Общий вывод

В датасете присутствует большое количество данных, из-за чего возникает сложность в обработке и дальнейшем масштабировании модели. Данные методы были выбраны на основе того, что они чаще всего используются в индустрии, а значит их сочетание может привести к неплохоим результатам.
Наилучший результат показало сочетание выделение Фичей из комментариев + KNN, поэтому на этом методе и обрабатывался test.  
На основе предобученной модели обработки естeственного языка Bert + KNN классификатора можно было получить высокий score, однако данная модель не подходит для масштабирования.

Также были предложены инициативы для внедрения системы ранжирования комментариев ВКонтакте:
- Предварительный рейтинг в поисковой строке для еще не опубликованного комментария
- Создание отдельного сервиса для комментаторов

**NLP Hell Yeah!**
